#Prediction of the Fc-site glycosylation distributon of Fc-EPO protein for quadruple Î²-1,4-galacosyltransferase knockouts
#using of triple-knockouts of b4GalT for training and validation
#The present file trains a network of 2 hidden layers and tunes the number of neurons in each layer
#The script is developed for Python 3.7

import numpy as np

#######################
#Defining the sigmoid activation function and its derivative
def act_func_sigmoid(x):
    return 1/(1+np.exp(-x))

def act_func_sigmoid_der(x):
    return act_func_sigmoid(x)*(1-act_func_sigmoid(x))
########################

error = np.zeros([15, 15]) #recording the difference between the output of the network and the experimental data

### Define the training set
for i in range(1, 16):
    print(i)
    for j in range(1, 16):

        np.random.seed(0)
        inputs = np.array([[0.364963503649635,	0.364963503649635,	0.364963503649635,	0.364963503649635],
        [0.357578579377415,	0.372348427921854,	0.357578579377415,	0.372348427921854],
        [0.372348427921854,	0.357578579377415,	0.372348427921854,	0.357578579377415],
        [0.352368437441139,	0.368452255809828,	0.377558569858131,	0.377558569858131],
        [0.368452255809828,	0.352368437441139,	0.361474751489441,	0.361474751489441],
        [0.361474751489441,	0.361474751489441,	0.368452255809828,	0.352368437441139],
        [0.377558569858131,	0.377558569858131,	0.352368437441139,	0.368452255809828],
        [0.348166563383002,	0.38176044391627,	0.370315070194686,	0.359611937104584],
        [0.366685883408142,	0.36324112389113,	0.355250220156728,	0.374676787142544],
        [0.359611937104584,	0.355250220156728,	0.38176044391627,	0.366685883408142],
        [0.374676787142544,	0.370315070194686,	0.36324112389113,	0.348166563383002],
        [0.355250220156728,	0.359611937104584,	0.359611937104584,	0.370315070194686],
        [0.370315070194686,	0.374676787142544,	0.374676787142544,	0.355250220156728],
        [0.36324112389113,	0.366685883408142,	0.348166563383002,	0.36324112389113],
        [0.38176044391627,	0.348166563383002,	0.366685883408142,	0.38176044391627],
        [0.344568629188814,	0.365822033716055,	0.362366400262823,	0.356462535461884],
        [0.344160583941606,	0.00113138686131387,	0.000072992700729927,	0],
        [0.337196600352903,	0.00115428012655775,	7.15157158754831E-05,	0],
        [0.351124567530308,	0.00110849359606999,	7.44696855843708E-05,	0],
        [0.332283436506994,	0.00114220199301047,	7.55117139716263E-05,	0],
        [0.347450477228668,	0.00109234215606753,	7.22949502978882E-05,	0],
        [0.340870690654543,	0.00112057172961727,	7.36904511619657E-05,	0],
        [0.356037731376218,	0.00117043156656021,	7.04736874882277E-05,	0],
        [0.32832106927017,	0.00118345737614044,	7.40630140389372E-05,	0],
        [0.345784788053878,	0.0011260474840625,	7.10500440313455E-05,	0],
        [0.339114056689623,	0.00110127568248586,	0.000076352088783254,	0],
        [0.353320210275419,	0.00114797671760353,	7.26482247782259E-05,	0],
        [0.335000957607794,	0.00111479700502421,	7.19223874209168E-05,	0],
        [0.349207111193589,	0.00116149804014189,	7.49353574285088E-05,	0],
        [0.342536379829335,	0.00113672623856524,	6.96333126766003E-05,	0],
        [0.360000098613043,	0.0010793163464873,	7.33371766816285E-05,	0],
        [0.324928217325051,	0.00113404830451977,	7.24732800525647E-05,	0],
        [0.387773722627737,	0.00164233576642336,	0.000182481751824818,	0.000218978102189781],
        [0.379927240588504,	0.00167556792564834,	0.000178789289688708,	0.000223409056753112],
        [0.39562020466697,	0.00160910360719837,	0.000186174213960927,	0.000214547147626449],
        [0.37439146478121,	0.00165803515114423,	0.000188779284929066,	0.000226535141914879],
        [0.391480521797943,	0.00158565796848512,	0.000180737375744721,	0.000216884850893665],
        [0.384066923457531,	0.00162663638170249,	0.000184226127904914,	0.000211421062464683],
        [0.401155980474265,	0.00169901356436159,	0.000176184218720569,	0.000221071353485897],
        [0.369926973594439,	0.00171792199762322,	0.000185157535097343,	0.00021576716226275],
        [0.389603751121151,	0.00163458505751008,	0.000177625110078364,	0.000224806072285526],
        [0.38208768317362,	0.00159862599070527,	0.000190880221958135,	0.000220011530044885],
        [0.398094086338953,	0.00166641781587609,	0.000181620561945565,	0.000208899938029801],
        [0.377453358916523,	0.00161825371697063,	0.000179805968552292,	0.000222189042116812],
        [0.393459762081854,	0.00168604554214145,	0.000187338393571272,	0.000213150132094037],
        [0.385943694134325,	0.00165008647533664,	0.000174083281691501,	0.000217944674334678],
        [0.405620471661037,	0.00156674953522351,	0.000183342941704071,	0.000229056266349762],
        [0.366104168513115,	0.00164619915172225,	0.000181183200131412,	0.00021387752127713],
        [0.000072992700729927,	1,	3.64963503649635E-05,	0],
        [7.15157158754831E-05,	1.02023469250588,	3.57578579377415E-05,	0],
        [7.44696855843708E-05,	0.979765307494118,	3.72348427921854E-05,	0],
        [7.04736874882277E-05,	1.00955918091893,	3.77558569858131E-05,	0],
        [7.36904511619657E-05,	0.96548951858872,	3.61474751489441E-05,	0],
        [7.22949502978882E-05,	0.990440819081069,	3.68452255809828E-05,	0],
        [7.55117139716263E-05,	1.03451048141128,	3.52368437441139E-05,	0],
        [6.96333126766003E-05,	1.04602361633058,	3.70315070194686E-05,	0],
        [7.33371766816285E-05,	0.995280679461695,	3.55250220156728E-05,	0],
        [7.19223874209168E-05,	0.973385603229434,	0.000038176044391627,	0],
        [7.49353574285088E-05,	1.01466329233344,	3.63241123891129E-05,	0],
        [7.10500440313455E-05,	0.98533670766656,	3.59611937104584E-05,	0],
        [7.40630140389372E-05,	1.02661439677057,	3.74676787142544E-05,	0],
        [7.26482247782259E-05,	1.00471932053831,	3.48166563383001E-05,	0],
        [0.000076352088783254,	0.953976383669424,	3.66685883408142E-05,	0],
        [6.89137258377628E-05,	1.00235237238199,	3.62366400262823E-05,	0],
        [3.64963503649635E-05,	0.836532846715328,	3.64963503649635E-05,	3.64963503649635E-05],
        [3.57578579377415E-05,	0.853459831639682,	3.57578579377415E-05,	3.72348427921854E-05],
        [3.72348427921854E-05,	0.819605861790974,	3.72348427921854E-05,	3.57578579377415E-05],
        [3.52368437441139E-05,	0.844529415541708,	3.77558569858131E-05,	3.77558569858131E-05],
        [3.68452255809828E-05,	0.807663695458834,	3.61474751489441E-05,	3.61474751489441E-05],
        [3.61474751489441E-05,	0.828536277888948,	3.68452255809828E-05,	3.52368437441139E-05],
        [3.77558569858131E-05,	0.865401997971823,	3.52368437441139E-05,	3.68452255809828E-05],
        [3.48166563383001E-05,	0.875033113500483,	3.70315070194686E-05,	3.59611937104584E-05],
        [3.66685883408142E-05,	0.832584980070858,	3.55250220156728E-05,	3.74676787142544E-05],
        [3.59611937104584E-05,	0.814269029621236,	0.000038176044391627,	3.66685883408142E-05],
        [3.74676787142544E-05,	0.84879917239324,	3.63241123891129E-05,	3.48166563383001E-05],
        [3.55250220156728E-05,	0.824266521037417,	3.59611937104584E-05,	3.70315070194686E-05],
        [3.70315070194686E-05,	0.858796663809425,	3.74676787142544E-05,	3.55250220156728E-05],
        [3.63241123891129E-05,	0.840480713359803,	3.48166563383001E-05,	3.63241123891129E-05],
        [0.000038176044391627,	0.798032579930178,	3.66685883408142E-05,	0.000038176044391627],
        [3.44568629188814E-05,	0.838500683480569,	3.62366400262823E-05,	3.56462535461884E-05],
        [0.00010948905109489,	0.771094890510949,	0,	0],
        [0.000107273573813225,	0.786697758513293,	0,	0],
        [0.000111704528376556,	0.755492022508603,	0,	0],
        [0.000105710531232342,	0.778465926075005,	0,	0],
        [0.000110535676742949,	0.744484034625638,	0,	0],
        [0.000108442425446832,	0.763723854946891,	0,	0],
        [0.000113267570957439,	0.79770574639626,	0,	0],
        [0.0001044499690149,	0.806583465906295,	0,	0],
        [0.000110005765022443,	0.767455846557178,	0,	0],
        [0.000107883581131375,	0.750572665147134,	0,	0],
        [0.000112403036142763,	0.782401680307333,	0,	0],
        [0.000106575066047018,	0.759788100714565,	0,	0],
        [0.000111094521058406,	0.791617115874766,	0,	0],
        [0.000108972337167339,	0.774733934464723,	0,	0],
        [0.000114528133174881,	0.735606315115605,	0,	0],
        [0.000103370588756644,	0.77290879283528,	0,	0],
        [0.000072992700729927,	0.000583941605839416,	0.567737226277372,	0],
        [7.15157158754831E-05,	0.000595757484674966,	0.556249238079507,	0],
        [7.44696855843708E-05,	0.000572125727003864,	0.579225214475236,	0],
        [7.04736874882277E-05,	0.000589523609295725,	0.587330111271309,	0],
        [7.36904511619657E-05,	0.000563789499905822,	0.562310123416975,	0],
        [7.22949502978882E-05,	0.000578359602383106,	0.573164329137769,	0],
        [7.55117139716263E-05,	0.00060409371177301,	0.548144341283435,	0],
        [6.96333126766003E-05,	0.000610816710266032,	0.576062123194854,	0],
        [7.33371766816285E-05,	0.000581185798225807,	0.552627242475806,	0],
        [7.19223874209168E-05,	0.000568400352250764,	0.59386654655615,	0],
        [7.49353574285088E-05,	0.000592504112311498,	0.565057892325041,	0],
        [7.10500440313455E-05,	0.000575379099367334,	0.559412329359891,	0],
        [7.40630140389372E-05,	0.00059948285942807,	0.582847210078941,	0],
        [7.26482247782259E-05,	0.000586697413453028,	0.541607905998597,	0],
        [0.000076352088783254,	0.000557066501412802,	0.570416560229706,	0],
        [6.89137258377628E-05,	0.000585315253945688,	0.563697172248848,	0],
        [0.00010948905109489,	0.0012043795620438,	0.255401459854015,	0],
        [0.000107273573813225,	0.00122874981214212,	0.250233489848315,	0],
        [0.000111704528376556,	0.00118000931194547,	0.260569429859713,	0],
        [0.000105710531232342,	0.00121589244417243,	0.26421548718672,	0],
        [0.000110535676742949,	0.00116281584355576,	0.252960031092311,	0],
        [0.000108442425446832,	0.00119286667991516,	0.257842888615718,	0],
        [0.000113267570957439,	0.00124594328053183,	0.246587432521309,	0],
        [0.0001044499690149,	0.00125980946492369,	0.259146486122241,	0],
        [0.000110005765022443,	0.00119869570884073,	0.248604104065678,	0],
        [0.000107883581131375,	0.0011723257265172,	0.267155958652606,	0],
        [0.000112403036142763,	0.00122203973164246,	0.254196138499012,	0],
        [0.000106575066047018,	0.00118671939244513,	0.251656433585788,	0],
        [0.000111094521058406,	0.00123643339757039,	0.262198815642352,	0],
        [0.000108972337167339,	0.00121006341524687,	0.243646961055424,	0],
        [0.000114528133174881,	0.0011489496591639,	0.256606781209018,	0],
        [0.000103370588756644,	0.00120721271126298,	0.253584006903924,	0],
        [0.000328467153284672,	0.00591240875912409,	0.61485401459854,	0],
        [0.000321820721439674,	0.00603204453233403,	0.602412632677132,	0],
        [0.000335113585129669,	0.00579277298591413,	0.627295396519947,	0],
        [0.000317131593697025,	0.00596892654411922,	0.636072922639994,	0],
        [0.000331607030228846,	0.00570836868654645,	0.608976513834262,	0],
        [0.000325327276340497,	0.00585589097412895,	0.620731515362818,	0],
        [0.000339802712872318,	0.00611644883170173,	0.593635106557086,	0],
        [0.000313349907044701,	0.00618451919144357,	0.623869798756988,	0],
        [0.000330017295067328,	0.0058845062070363,	0.598490045898039,	0],
        [0.000323650743394126,	0.00575505356653899,	0.64315181986574,	0],
        [0.000337209108428289,	0.00599910413715391,	0.611952321419386,	0],
        [0.000319725198141055,	0.00582571338109426,	0.605838230440093,	0],
        [0.000333283563175217,	0.00606976395170921,	0.631217983299044,	0],
        [0.000326917011502017,	0.00594031131121191,	0.586556209331343,	0],
        [0.000343584399524643,	0.00564029832680462,	0.617755707777697,	0],
        [0.000310111766269932,	0.00592631694620009,	0.610478674522778,	0]])



        outputs = np.array([[0,	0.0065,	0.0255,	0,	0.1935,	0.431,	0.0055,	0.2315,	0.017,	0.046,	0.014,	0.0295],
        [0,	0.00663152550128822,	0.0249840153411,	0,	0.189584587000112,	0.439721152470034,	0.00538870919121765,	0.236184331315111,	0.0173439897726,	0.0450692041447294,	0.0142832856950823,	0.0289030765710765],
        [0,	0.00636847449871177,	0.0260159846588999,	0,	0.197415412999888,	0.422278847529965,	0.00561129080878234,	0.226815668684888,	0.0166560102274,	0.0469307958552705,	0.0137167143049177,	0.0300969234289235],
        [0,	0.00656213467597304,	0.0263800172759876,	0,	0.195349701507813,	0.416125982511738,	0.00544742450494588,	0.229287049617267,	0.0175866781839918,	0.0464397223222708,	0.014133828532865,	0.0305180592016328],
        [0,	0.00627568187082668,	0.0252562408865673,	0,	0.186822221846917,	0.435120006976059,	0.00568980764776204,	0.239489176446711,	0.0168374939243782,	0.0444125178550811,	0.0135168532602421,	0.0292180041628915],
        [0,	0.00643786532402695,	0.0257437591134327,	0,	0.200177778153083,	0.445874017488262,	0.00531019235223796,	0.233712950382732,	0.0164133218160082,	0.0475874821449189,	0.013866171467135,	0.0297819958371084],
        [0,	0.00672431812917332,	0.0246199827240124,	0,	0.191650298492187,	0.426879993023941,	0.00555257549505412,	0.223510823553289,	0.0171625060756218,	0.0455602776777292,	0.0144831467397579,	0.0284819407983672],
        [0,	0.00679915350614877,	0.0258739139545027,	0,	0.188350114224895,	0.411163821361522,	0.00547404373703932,	0.232592522704619,	0.0174524447450997,	0.0466745114473382,	0.0133556693713719,	0.0287148752952683],
        [0,	0.00646932441650102,	0.0248213328823506,	0,	0.196337347066521,	0.433034027152012,	0.00575312988981819,	0.220845532819472,	0.0167507240303315,	0.044775737748554,	0.0140660704875363,	0.0299325671238365],
        [0,	0.00632700642099132,	0.0266736022164298,	0,	0.192586811475838,	0.442470805008116,	0.00535362081776189,	0.228105447824809,	0.0162175985223802,	0.0481170863512067,	0.014372601554788,	0.02936078004412],
        [0,	0.00659531140016736,	0.0253796573262732,	0,	0.202405569759967,	0.424680121004287,	0.00558064810783392,	0.237661232852387,	0.0170802284491513,	0.045782911255238,	0.0137947139073318,	0.0308576966817521],
        [0,	0.00640468859983264,	0.0251260860454973,	0,	0.194413188524163,	0.419529194991886,	0.00524687011018183,	0.242154467180529,	0.0165475552549004,	0.0438829136487935,	0.0142052860926682,	0.0302851247047318],
        [0,	0.00667299357900871,	0.0261786671176495,	0,	0.184594430240034,	0.437319878995713,	0.00552595626296071,	0.230407477295382,	0.0172492759696685,	0.0462170887447623,	0.0136273984452121,	0.0290674328761635],
        [0,	0.00653067558349902,	0.0243263977835703,	0,	0.198649885775105,	0.45083617863848,	0.00541935189216608,	0.225338767147614,	0.0177824014776199,	0.0453254885526618,	0.0139339295124637,	0.0296392199558801],
        [0,	0.00620084649385126,	0.0256203426737269,	0,	0.190662652933479,	0.428965972847991,	0.00564637918223814,	0.234894552175191,	0.0169197715508488,	0.0472242622514462,	0.0146443306286281,	0.028142303318248],
        [0,	0.00651529042048294,	0.0253185403863635,	0,	0.193044815944084,	0.423511821142036,	0.00580735075812458,	0.227477927133135,	0.0163278144423752,	0.0473937864335645,	0.0139670667866521,	0.0306664396441137],
        [0,	0,	0.026,	0,	0.171,	0.397,	0,	0.272,	0.016,	0.058,	0.021,	0.039],
        [0,	0,	0.0254738979948471,	0,	0.167539867581494,	0.405033172924834,	0,	0.277503836361599,	0.0163237550800941,	0.0568263878346588,	0.0214249285426235,	0.0382108469922706],
        [0,	0,	0.0265261020051529,	0,	0.174460132418505,	0.388966827075165,	0,	0.2664961636384,	0.0156762449199059,	0.059173612165341,	0.0205750714573765,	0.0397891530077293],
        [0,	0,	0.0268972725166933,	0,	0.172634619937137,	0.383299338879722,	0,	0.269399902790051,	0.0165521677025805,	0.0585544324932979,	0.0212007427992975,	0.0403459087750399],
        [0,	0,	0.0257514612961078,	0,	0.165098707678671,	0.400794994824815,	0,	0.281386850943868,	0.0158470531052971,	0.0559983920781458,	0.0202752798903631,	0.0386271919441617],
        [0,	0,	0.0262485387038922,	0,	0.176901292321329,	0.410700661120278,	0,	0.274600097209949,	0.0154478322974195,	0.0600016079218542,	0.0207992572007024,	0.0393728080558383],
        [0,	0,	0.0251027274833067,	0,	0.169365380062863,	0.393205005175184,	0,	0.262613149056132,	0.0161529468947029,	0.057445567506702,	0.0217247201096369,	0.0376540912249601],
        [0,	0,	0.0263812456006694,	0,	0.166448938152233,	0.378728624316761,	0,	0.27328365518642,	0.0164258303483291,	0.0588504709553395,	0.0200335040570579,	0.0379620385259479],
        [0,	0,	0.0253080256839653,	0,	0.173507422989018,	0.398873570253709,	0,	0.259481576358083,	0.015765387322665,	0.0564563649873072,	0.0210991057313045,	0.0395718684010042],
        [0,	0,	0.0271966140245951,	0,	0.17019299618795,	0.407565915517916,	0,	0.268011584485304,	0.0152636221387108,	0.0606693697471736,	0.021558902332182,	0.0388159464990061],
        [0,	0,	0.0258772976660041,	0,	0.178870038392529,	0.391178672943624,	0,	0.279239115921595,	0.016075509128613,	0.0577262794087783,	0.0206920708609978,	0.0407949210368926],
        [0,	0,	0.0256187543993306,	0,	0.171807003812051,	0.386434084482085,	0,	0.284518423641918,	0.0155741696516709,	0.0553306302528266,	0.0213079291390022,	0.0400379614740522],
        [0,	0,	0.0266919743160348,	0,	0.163129961607472,	0.402821327056376,	0,	0.270716344813581,	0.016234612677335,	0.058273720591222,	0.0204410976678181,	0.0384281315989958],
        [0,	0,	0.024803385975405,	0,	0.175551061847768,	0.41527137568324,	0,	0.264760884078406,	0.0167363778612893,	0.0571495290446605,	0.0209008942686956,	0.0391840535009941],
        [0,	0,	0.0261227023339961,	0,	0.168492577010982,	0.395126429746293,	0,	0.275988415514696,	0.0159244908713871,	0.0595436350126931,	0.0219664959429422,	0.0372050789631075],
        [0,	0,	0.0258149823547235,	0,	0.170597744322679,	0.390102535947536,	0,	0.267274281555995,	0.0153673547692943,	0.0597573828944944,	0.0209506001799781,	0.0405420727498453],
        [0.02,	0,	0.043,	0,	0.141,	0.351,	0.011,	0.338,	0.029,	0.034,	0.012,	0.02],
        [0.0195953061498824,	0,	0.0421299082222471,	0,	0.138146908356671,	0.358102377069564,	0.0107774183824353,	0.344839326066987,	0.0295868060826705,	0.0333120204548,	0.0122428163100706,	0.0195953061498824],
        [0.0204046938501176,	0,	0.0438700917777528,	0,	0.143853091643329,	0.343897622930435,	0.0112225816175647,	0.331160673933012,	0.0284131939173294,	0.0346879795451999,	0.0117571836899294,	0.0204046938501176],
        [0.0193097903717744,	0,	0.044483950700685,	0,	0.142347844509569,	0.338886821024641,	0.0108948490098918,	0.334768996849401,	0.0300008039609271,	0.0343250121512436,	0.0121147101710272,	0.0206902096282256],
        [0.0201911836183786,	0,	0.042588955220486,	0,	0.13613402212101,	0.354355272502544,	0.0113796152955241,	0.349664542717013,	0.028722783753351,	0.0328266436320165,	0.0115858742230646,	0.0198088163816214],
        [0.0198088163816214,	0,	0.043411044779514,	0,	0.14586597787899,	0.363113178975359,	0.0106203847044759,	0.341231003150598,	0.0279991960390729,	0.0351733563679835,	0.0118852898289728,	0.0201911836183786],
        [0.0206902096282256,	0,	0.041516049299315,	0,	0.139652155490431,	0.347644727497455,	0.0111051509901082,	0.326335457282987,	0.029277216246649,	0.0336749878487563,	0.0124141257769354,	0.0193097903717744],
        [0.0190795276733885,	0,	0.0436305215703379,	0,	0.13724737005535,	0.334845710667968,	0.0109480874740786,	0.339595130341949,	0.0297718175063465,	0.034498551939337,	0.0114477166040331,	0.0194677120645887],
        [0.0200943864107662,	0,	0.0418555809388657,	0,	0.143067524219015,	0.352656481508947,	0.0115062597796364,	0.322444017680265,	0.0285747645223302,	0.0330951105098008,	0.0120566318464597,	0.0202932658466688],
        [0.0197067341533312,	0,	0.0449790155022149,	0,	0.140334575804099,	0.36034165326647,	0.0107072416355238,	0.333043807191297,	0.0276653151264133,	0.0355648029552397,	0.0123193727612468,	0.0199056135892339],
        [0.0205322879354114,	0,	0.0427970692168529,	0,	0.147489329902612,	0.345853184390963,	0.0111612962156678,	0.346995666108453,	0.029136860295611,	0.0338395431016976,	0.0118240404919987,	0.0209204723266116],
        [0.0194677120645887,	0,	0.0423694784296621,	0,	0.141665424195902,	0.341658346733531,	0.0104937402203637,	0.353555982319736,	0.0282281824936536,	0.0324351970447604,	0.0121759595080013,	0.0205322879354114],
        [0.0202932658466688,	0,	0.0441444190611345,	0,	0.134510670097389,	0.356146815609037,	0.0110519125259214,	0.336404869658053,	0.0294252354776698,	0.0341604568983025,	0.0116806272387532,	0.0197067341533312],
        [0.0199056135892339,	0,	0.0410209844977852,	0,	0.14475262994465,	0.367154289332034,	0.0108387037843322,	0.329004333891549,	0.0303346848735868,	0.033501448060663,	0.0119433681535403,	0.0200943864107662],
        [0.0209204723266116,	0,	0.0432029307831473,	0,	0.138932475780985,	0.349343518491055,	0.0112927583644763,	0.342956192808703,	0.0288631397043892,	0.0349048894901994,	0.012552283395967,	0.0190795276733885],
        [0.018882360879547,	0,	0.0426940092789658,	0,	0.140668315494139,	0.344901738331449,	0.0116147015162492,	0.332127599874729,	0.0278533305193459,	0.0350301899726347,	0.0119717715314161,	0.0207908065383822],
        [0,	0,	0.049,	0,	0,	0.043,	0,	0.847,	0.062,	0,	0,	0],
        [0,	0,	0.0480085000672118,	0,	0,	0.0438700917777528,	0,	0.86413878455248,	0.0632545509353646,	0,	0,	0],
        [0,	0,	0.0499914999327881,	0,	0,	0.0421299082222471,	0,	0.829861215447518,	0.0607454490646353,	0,	0,	0],
        [0,	0,	0.0506910135891527,	0,	0,	0.041516049299315,	0,	0.838903373761665,	0.0641396498474994,	0,	0,	0],
        [0,	0,	0.0485316001349724,	0,	0,	0.043411044779514,	0,	0.876230377755354,	0.0614073307830263,	0,	0,	0],
        [0,	0,	0.0494683998650276,	0,	0,	0.044483950700685,	0,	0.855096626238334,	0.0598603501525006,	0,	0,	0],
        [0,	0,	0.0473089864108473,	0,	0,	0.042588955220486,	0,	0.817769622244646,	0.0625926692169737,	0,	0,	0],
        [0,	0,	0.0497185013243386,	0,	0,	0.0410209844977852,	0,	0.850997264495949,	0.0636500925997753,	0,	0,	0],
        [0,	0,	0.0476958945582423,	0,	0,	0.0432029307831473,	0,	0.808017996968002,	0.0610908758753267,	0,	0,	0],
        [0,	0,	0.0512551572001984,	0,	0,	0.0441444190611345,	0,	0.834580191393576,	0.0591465357875043,	0,	0,	0],
        [0,	0,	0.0487687532936231,	0,	0,	0.0423694784296621,	0,	0.869542394064673,	0.0622925978733752,	0,	0,	0],
        [0,	0,	0.0482814986756614,	0,	0,	0.0418555809388657,	0,	0.885982003032001,	0.0603499074002249,	0,	0,	0],
        [0,	0,	0.0503041054417579,	0,	0,	0.0436305215703379,	0,	0.843002735504056,	0.0629091241246733,	0,	0,	0],
        [0,	0,	0.0467448427998018,	0,	0,	0.0449790155022149,	0,	0.824457605935331,	0.064853464212496,	0,	0,	0],
        [0,	0,	0.0492312467063772,	0,	0,	0.0427970692168529,	0,	0.859419808606424,	0.0617074021266251,	0,	0,	0],
        [0,	0,	0.0486513128992867,	0,	0,	0.0422529195106903,	0,	0.832284251757086,	0.0595484997310154,	0,	0,	0],
        [0,	0,	0.055,	0,	0,	0.049,	0,	0.835,	0.061,	0,	0,	0],
        [0,	0,	0.0538870919121765,	0,	0,	0.0499914999327881,	0,	0.85189596824241,	0.0622343162428587,	0,	0,	0],
        [0,	0,	0.0561129080878234,	0,	0,	0.0480085000672118,	0,	0.818104031757589,	0.0597656837571412,	0,	0,	0],
        [0,	0,	0.0568980764776204,	0,	0,	0.0473089864108473,	0,	0.827018083932692,	0.0631051393660881,	0,	0,	0],
        [0,	0,	0.0544742450494588,	0,	0,	0.0494683998650276,	0,	0.863816251978419,	0.0604168899639452,	0,	0,	0],
        [0,	0,	0.0555257549505411,	0,	0,	0.0506910135891527,	0,	0.842981916067306,	0.0588948606339119,	0,	0,	0],
        [0,	0,	0.0531019235223796,	0,	0,	0.0485316001349724,	0,	0.806183748021581,	0.0615831100360547,	0,	0,	0],
        [0,	0,	0.0558064810783392,	0,	0,	0.0467448427998018,	0,	0.838940632649489,	0.0626234782030048,	0,	0,	0],
        [0,	0,	0.0535362081776189,	0,	0,	0.0492312467063772,	0,	0.796570280363969,	0.0601055391676602,	0,	0,	0],
        [0,	0,	0.0575312988981819,	0,	0,	0.0503041054417579,	0,	0.822756150901578,	0.0581925594038349,	0,	0,	0],
        [0,	0,	0.0547404373703932,	0,	0,	0.0482814986756614,	0,	0.857223021303426,	0.0612878785528369,	0,	0,	0],
        [0,	0,	0.0541935189216608,	0,	0,	0.0476958945582423,	0,	0.873429719636034,	0.0593765217969955,	0,	0,	0],
        [0,	0,	0.0564637918223814,	0,	0,	0.0497185013243386,	0,	0.831059367350515,	0.0618944608323398,	0,	0,	0],
        [0,	0,	0.0524687011018183,	0,	0,	0.0512551572001984,	0,	0.812776978696577,	0.0638074405961654,	0,	0,	0],
        [0,	0,	0.0552595626296071,	0,	0,	0.0487687532936231,	0,	0.847243849098422,	0.0607121214471634,	0,	0,	0],
        [0,	0,	0.0546086165196075,	0,	0,	0.0481486757214843,	0,	0.820492739335498,	0.0585880400579345,	0,	0,	0],
        [0.011,	0,	0.055,	0,	0,	0.048,	0,	0.825,	0.061,	0,	0,	0],
        [0.0107774183824353,	0,	0.0538870919121765,	0,	0,	0.0489712652402822,	0,	0.841693621317351,	0.0622343162428587,	0,	0,	0],
        [0.0112225816175647,	0,	0.0561129080878234,	0,	0,	0.0470287347597177,	0,	0.808306378682647,	0.0597656837571412,	0,	0,	0],
        [0.0106203847044759,	0,	0.0568980764776204,	0,	0,	0.0463434968922586,	0,	0.817113675741882,	0.0631051393660881,	0,	0,	0],
        [0.0111051509901082,	0,	0.0544742450494588,	0,	0,	0.0484588406841086,	0,	0.853471147164306,	0.0604168899639452,	0,	0,	0],
        [0.0108948490098918,	0,	0.0555257549505411,	0,	0,	0.0496565031077414,	0,	0.832886324258117,	0.0588948606339119,	0,	0,	0],
        [0.0113796152955241,	0,	0.0531019235223796,	0,	0,	0.0475411593158913,	0,	0.796528852835694,	0.0615831100360547,	0,	0,	0],
        [0.0104937402203637,	0,	0.0558064810783392,	0,	0,	0.0457908664161324,	0,	0.828893439444106,	0.0626234782030048,	0,	0,	0],
        [0.0110519125259214,	0,	0.0535362081776189,	0,	0,	0.0482265273858389,	0,	0.787030516527275,	0.0601055391676602,	0,	0,	0],
        [0.0108387037843322,	0,	0.0575312988981819,	0,	0,	0.0492774910449874,	0,	0.812902783824912,	0.0581925594038349,	0,	0,	0],
        [0.0112927583644763,	0,	0.0547404373703932,	0,	0,	0.0472961619679949,	0,	0.84695687733572,	0.0612878785528369,	0,	0,	0],
        [0.0107072416355238,	0,	0.0541935189216608,	0,	0,	0.0467225089550128,	0,	0.862969483472729,	0.0593765217969955,	0,	0,	0],
        [0.0111612962156678,	0,	0.0564637918223814,	0,	0,	0.0487038380320051,	0,	0.821106560555898,	0.0618944608323398,	0,	0,	0],
        [0.0109480874740786,	0,	0.0524687011018183,	0,	0,	0.0502091335838678,	0,	0.803043122664283,	0.0638074405961654,	0,	0,	0],
        [0.0115062597796364,	0,	0.0552595626296071,	0,	0,	0.0477734726141614,	0,	0.837097216175088,	0.0607121214471634,	0,	0,	0],
        [0.0103852984837509,	0,	0.0546086165196075,	0,	0,	0.047166049686352,	0,	0.810666478984175,	0.0585880400579345,	0,	0,	0],
        [0,	0,	0.05,	0,	0,	0.036,	0,	0.869,	0.045,	0,	0,	0],
        [0,	0,	0.0489882653747059,	0,	0,	0.0367284489302117,	0,	0.88658394778761,	0.0459105611627646,	0,	0,	0],
        [0,	0,	0.051011734625294,	0,	0,	0.0352715510697883,	0,	0.851416052212389,	0.0440894388372353,	0,	0,	0],
        [0,	0,	0.051725524070564,	0,	0,	0.0347576226691939,	0,	0.860693071781449,	0.0465529716635076,	0,	0,	0],
        [0,	0,	0.0495220409540535,	0,	0,	0.0363441305130815,	0,	0.898989608346402,	0.0445698368586481,	0,	0,	0],
        [0,	0,	0.0504779590459465,	0,	0,	0.0372423773308061,	0,	0.87730692821855,	0.0434470283364924,	0,	0,	0],
        [0,	0,	0.048274475929436,	0,	0,	0.0356558694869185,	0,	0.839010391653598,	0.0454301631413518,	0,	0,	0],
        [0,	0,	0.050733164616672,	0,	0,	0.0343431498120993,	0,	0.873101089547792,	0.0461976478546757,	0,	0,	0],
        [0,	0,	0.0486692801614717,	0,	0,	0.0361698955393792,	0,	0.82900547740873,	0.0443401518449952,	0,	0,	0],
        [0,	0,	0.052301180816529,	0,	0,	0.0369581182837405,	0,	0.856257598962241,	0.0429289372651241,	0,	0,	0],
        [0,	0,	0.0497640339730848,	0,	0,	0.0354721214759962,	0,	0.892127910793626,	0.0452123694242239,	0,	0,	0],
        [0,	0,	0.049266835383328,	0,	0,	0.0350418817162596,	0,	0.908994522591274,	0.0438023521453245,	0,	0,	0],
        [0,	0,	0.0513307198385285,	0,	0,	0.0365278785240038,	0,	0.864898910452213,	0.0456598481550048,	0,	0,	0],
        [0,	0,	0.0476988191834712,	0,	0,	0.0376568501879009,	0,	0.845872089206378,	0.0470710627348761,	0,	0,	0],
        [0,	0,	0.0502359660269155,	0,	0,	0.035830104460621,	0,	0.881742401037759,	0.0447876305757763,	0,	0,	0],
        [0,	0,	0.0496441968360068,	0,	0,	0.035374537264764,	0,	0.853902024529998,	0.0432206852886402,	0,	0,	0],
        [0,	0,	0.068,	0,	0,	0.03,	0,	0.864,	0.038,	0,	0,	0],
        [0,	0,	0.0666240409096,	0,	0,	0.0306070407751764,	0,	0.88148277432508,	0.0387689183152234,	0,	0,	0],
        [0,	0,	0.0693759590903999,	0,	0,	0.0293929592248235,	0,	0.846517225674918,	0.0372310816847765,	0,	0,	0],
        [0,	0,	0.070346712735967,	0,	0,	0.0289646855576616,	0,	0.855740867686044,	0.0393113982936286,	0,	0,	0],
        [0,	0,	0.0673499756975127,	0,	0,	0.0302867754275679,	0,	0.893817055939346,	0.0376367511250806,	0,	0,	0],
        [0,	0,	0.0686500243024872,	0,	0,	0.0310353144423384,	0,	0.872259132313956,	0.0366886017063714,	0,	0,	0],
        [0,	0,	0.065653287264033,	0,	0,	0.0297132245724321,	0,	0.834182944060654,	0.0383632488749193,	0,	0,	0],
        [0,	0,	0.0689971038786739,	0,	0,	0.0286192915100827,	0,	0.8680774929451,	0.0390113470772817,	0,	0,	0],
        [0,	0,	0.0661902210196015,	0,	0,	0.0301415796161493,	0,	0.824235595490382,	0.0374427948913293,	0,	0,	0],
        [0,	0,	0.0711296059104795,	0,	0,	0.0307984319031171,	0,	0.851330915423908,	0.0362511025794381,	0,	0,	0],
        [0,	0,	0.0676790862033953,	0,	0,	0.0295601012299968,	0,	0.886994838809773,	0.0381793341804558,	0,	0,	0],
        [0,	0,	0.0670028961213261,	0,	0,	0.029201568096883,	0,	0.903764404509621,	0.0369886529227185,	0,	0,	0],
        [0,	0,	0.0698097789803988,	0,	0,	0.0304398987700032,	0,	0.859922507054905,	0.0385572051086707,	0,	0,	0],
        [0,	0,	0.0648703940895208,	0,	0,	0.0313807084899174,	0,	0.841005161190231,	0.039748897420562,	0,	0,	0],
        [0,	0,	0.0683209137966051,	0,	0,	0.0298584203838508,	0,	0.876669084576092,	0.0378206658195444,	0,	0,	0],
        [0,	0,	0.0675161076969693,	0,	0,	0.02947878105397,	0,	0.848988894354336,	0.036497467577074,	0,	0,	0],
        [0,	0,	0.047,	0,	0,	0.032,	0,	0.884,	0.037,	0,	0,	0],
        [0,	0,	0.0460489694522235,	0,	0,	0.0326475101601882,	0,	0.901887468175198,	0.0377486836227176,	0,	0,	0],
        [0,	0,	0.0479510305477764,	0,	0,	0.0313524898398118,	0,	0.8661125318248,	0.0362513163772824,	0,	0,	0],
        [0,	0,	0.0486219926263302,	0,	0,	0.030895664594839,	0,	0.875549684067665,	0.0382768878122174,	0,	0,	0],
        [0,	0,	0.0465507184968102,	0,	0,	0.0323058937894058,	0,	0.914507265567572,	0.0366463103059996,	0,	0,	0],
        [0,	0,	0.0474492815031897,	0,	0,	0.033104335405161,	0,	0.892450315932334,	0.0357231121877826,	0,	0,	0],
        [0,	0,	0.0453780073736698,	0,	0,	0.0316941062105942,	0,	0.853492734432428,	0.0373536896940004,	0,	0,	0],
        [0,	0,	0.0476891747396717,	0,	0,	0.0305272442774216,	0,	0.888171879355866,	0.0379847326805111,	0,	0,	0],
        [0,	0,	0.0457491233517834,	0,	0,	0.0321510182572259,	0,	0.843315123163771,	0.0364574581836627,	0,	0,	0],
        [0,	0,	0.0491631099675373,	0,	0,	0.0328516606966582,	0,	0.871037649577239,	0.0352971261957687,	0,	0,	0],
        [0,	0,	0.0467781919346997,	0,	0,	0.0315307746453299,	0,	0.907527126745184,	0.0371746148599175,	0,	0,	0],
        [0,	0,	0.0463108252603283,	0,	0,	0.0311483393033419,	0,	0.924684876836233,	0.0360152673194891,	0,	0,	0],
        [0,	0,	0.0482508766482168,	0,	0,	0.0324692253546701,	0,	0.879828120644138,	0.0375425418163373,	0,	0,	0],
        [0,	0,	0.0448368900324629,	0,	0,	0.0334727557225786,	0,	0.86047287325482,	0.0387028738042315,	0,	0,	0],
        [0,	0,	0.0472218080653006,	0,	0,	0.0318489817427742,	0,	0.896962350422761,	0.0368253851400827,	0,	0,	0],
        [0,	0,	0.0466655450258464,	0,	0,	0.0314440331242347,	0,	0.868641415056982,	0.0355370079039931,	0,	0,	0]])

        #learning rate
        lr = 0.5 

        #initial values for the weights
        wh1 = np.random.rand(len(inputs[0]),i)
        wo1 = np.random.rand(i, j)
        wh2 = np.random.rand(i, j)
        wo2 = np.random.rand(j, len(outputs[0]))

        ### Neural network training        
        for epoch in range(20000):
            
            zh1 = np.dot(inputs, wh1)
            afh1 = act_func_sigmoid(zh1)

            zo1 = np.dot(afh1, wo1)
            afo1 = act_func_sigmoid(zo1)

            zh2 = np.dot(afh1, wh2)
            afh2 = act_func_sigmoid(zh2)
            
            zo2 = np.dot(afo1, wo2)
            afo2 = act_func_sigmoid(zo2)

            ###1st hidden Layer
            error_out1 = ((0.5)*(np.power((afo1 - afh2), 2)))
            cost_afo1_der = afo1 - afh2
            afo_zo1_der = act_func_sigmoid_der(zo1)
            zo_wo1_der = afh1
            cost_wo1_der = np.dot(zo_wo1_der.T, cost_afo1_der*afo_zo1_der)

            cost_zo1_der = cost_afo1_der * afo_zo1_der
            zo_afh1_der = wo1
            cost_afh1_der = np.dot(cost_zo1_der, zo_afh1_der.T)
            afh_zh1_der = act_func_sigmoid_der(zh1)
            zh_wh1_der = inputs
            cost_wh1_der = np.dot(zh_wh1_der.T, afh_zh1_der*cost_afh1_der)

            #update weights
            wh1 -= lr*cost_wh1_der
            wo1 -= lr*cost_wo1_der

            #2nd hidden layer
            error_out2 = ((0.5)*(np.power((afo2 - outputs), 2)))
            cost_afo2_der = afo2 - outputs
            afo_zo2_der = act_func_sigmoid_der(zo2)
            zo_wo2_der = afh2
            cost_wo2_der = np.dot(zo_wo2_der.T, cost_afo2_der*afo_zo2_der)

            cost_zo2_der = cost_afo2_der * afo_zo2_der
            zo_afh2_der = wo2
            cost_afh2_der = np.dot(cost_zo2_der, zo_afh2_der.T)
            afh_zh2_der = act_func_sigmoid_der(zh2)
            zh_wh2_der = afh1
            cost_wh2_der = np.dot(zh_wh2_der.T, afh_zh2_der*cost_afh2_der)

            #update weights
            wh2 -= lr*cost_wh2_der
            wo2 -= lr*cost_wo2_der   

        #Validation set (tuning of the hyperparameters)
        validation_point = np.array([[3.64963503649635E-05,	0.0022992700729927,	0,	0.255839416058394],
        [3.57578579377415E-05,	0.00234579509590768,	0,	0.26101624797322],
        [3.72348427921854E-05,	0.00225274505007772,	0,	0.250662584143568],
        [3.52368437441139E-05,	0.00232124921160192,	0,	0.26466855747055],
        [3.68452255809828E-05,	0.00221992115587917,	0,	0.253393800794098],
        [3.61474751489441E-05,	0.00227729093438348,	0,	0.247010274646238],
        [3.77558569858131E-05,	0.00237861899010623,	0,	0.25828503132269],
        [3.48166563383001E-05,	0.0024050907966725,	0,	0.252087967910313],
        [3.66685883408142E-05,	0.00228841908051412,	0,	0.262648427786923],
        [3.59611937104584E-05,	0.00223807638698738,	0,	0.257046804269108],
        [3.74676787142544E-05,	0.00233298494222652,	0,	0.244064760931484],
        [3.55250220156728E-05,	0.00226555520375888,	0,	0.259590864206475],
        [3.70315070194686E-05,	0.00236046375899803,	0,	0.249030404329866],
        [3.63241123891129E-05,	0.0023101210654713,	0,	0.254632027847682],
        [0.000038176044391627,	0.00219344934931291,	0,	0.267614071185305],
        [3.44568629188814E-05,	0.00230467881241114,	0,	0.249880237358781],
        [3.64963503649635E-05,	0.00208029197080292,	0,	0.401459854014599],
        [3.57578579377415E-05,	0.00212238603915457,	0,	0.409583270714039],
        [3.72348427921854E-05,	0.00203819790245127,	0,	0.393336437315157],
        [3.52368437441139E-05,	0.00210017785811602,	0,	0.415314426843945],
        [3.68452255809828E-05,	0.00200850009341449,	0,	0.397622226638385],
        [3.61474751489441E-05,	0.00206040608348981,	0,	0.387605281185253],
        [3.77558569858131E-05,	0.00215208384819135,	0,	0.405297481390811],
        [3.48166563383001E-05,	0.00217603453032274,	0,	0.395573130815042],
        [3.66685883408142E-05,	0.00207047440617944,	0,	0.412144465856798],
        [3.59611937104584E-05,	0.00202492625489335,	0,	0.403354471748957],
        [3.74676787142544E-05,	0.00211079590010971,	0,	0.382983219721302],
        [3.55250220156728E-05,	0.00204978804149613,	0,	0.407346577214155],
        [3.70315070194686E-05,	0.0021356576867125,	0,	0.390775242172401],
        [3.63241123891129E-05,	0.00209010953542641,	0,	0.399565236280242],
        [0.000038176044391627,	0.00198454941128311,	0,	0.419936488307897],
        [3.44568629188814E-05,	0.00208518559218151,	0,	0.392108789008072],
        [3.64963503649635E-05,	0.00167883211678832,	0,	0.417043795620438],
        [3.57578579377415E-05,	0.00171280276844053,	0,	0.425482548586303],
        [3.72348427921854E-05,	0.00164486146513611,	0,	0.408605042654572],
        [3.52368437441139E-05,	0.00169488037672521,	0,	0.431436177776887],
        [3.68452255809828E-05,	0.00162089481222924,	0,	0.413057198526984],
        [3.61474751489441E-05,	0.00166278385685143,	0,	0.402651413463989],
        [3.77558569858131E-05,	0.0017367694213474,	0,	0.421030392713891],
        [3.48166563383001E-05,	0.00175609804201484,	0,	0.410928560529408],
        [3.66685883408142E-05,	0.0016709091698992,	0,	0.428143164667785],
        [3.59611937104584E-05,	0.00163415101272095,	0,	0.419011958970484],
        [3.74676787142544E-05,	0.00170344932289556,	0,	0.397849931977756],
        [3.55250220156728E-05,	0.00165421491068109,	0,	0.423159030711468],
        [3.70315070194686E-05,	0.0017235132208557,	0,	0.405944426573093],
        [3.63241123891129E-05,	0.00168675506367745,	0,	0.415075632270394],
        [0.000038176044391627,	0.00160156619156181,	0,	0.436237659263122],
        [3.44568629188814E-05,	0.00168278135509385,	0,	0.407329739272295]])

        #outputs of each layer using the validation data set 
        resulth1 = act_func_sigmoid(np.dot(validation_point, wh1))   #outputs of the input layer
        resulto1 = act_func_sigmoid(np.dot(resulth1, wo1))           #outputs of the 1st hidden layer
        resulto2 = act_func_sigmoid(np.dot(resulto1, wo2))           #outputs of the 2nd hidden layer

        #experimental data for the validation set
        experimental_results = np.array([[0.016,	0,	0.073,	0.013,	0,	0.016,	0,	0.817,	0.065,	0,	0,	0],
        [0.0156762449199059,	0,	0.0715228674470706,	0.0132630510025764,	0,	0.0163237550800941,	0,	0.833531743777304,	0.0663152550128822,	0,	0,	0],
        [0.0163237550800941,	0,	0.0744771325529292,	0.0127369489974235,	0,	0.0156762449199059,	0,	0.800468256222694,	0.0636847449871177,	0,	0,	0],
        [0.0154478322974195,	0,	0.0755192651430234,	0.0134486362583466,	0,	0.0154478322974195,	0,	0.809190149189233,	0.0672431812917332,	0,	0,	0],
        [0.0161529468947029,	0,	0.072302179792918,	0.0128757306480539,	0,	0.0161529468947029,	0,	0.845195063313016,	0.0643786532402695,	0,	0,	0],
        [0.0158470531052971,	0,	0.0736978202070819,	0.0125513637416534,	0,	0.0165521677025805,	0,	0.824809850810766,	0.0627568187082668,	0,	0,	0],
        [0.0165521677025805,	0,	0.0704807348569766,	0.0131242693519461,	0,	0.0158470531052971,	0,	0.788804936686984,	0.0656213467597304,	0,	0,	0],
        [0.0152636221387108,	0,	0.0740704203403411,	0.0128093771996653,	0,	0.0152636221387108,	0,	0.820855684879799,	0.0667299357900871,	0,	0,	0],
        [0.016075509128613,	0,	0.0710571490357487,	0.0133459871580174,	0,	0.016075509128613,	0,	0.77939870545792,	0.0640468859983264,	0,	0,	0],
        [0.015765387322665,	0,	0.0763597239921323,	0.013061351166998,	0,	0.0164258303483291,	0,	0.80502009016358,	0.0620084649385126,	0,	0,	0],
        [0.0164258303483291,	0,	0.0726554896007037,	0.0124016929877025,	0,	0.015765387322665,	0,	0.838743962161556,	0.0653067558349902,	0,	0,	0],
        [0.0155741696516709,	0,	0.0719295796596589,	0.0131906228003347,	0,	0.0155741696516709,	0,	0.854601294542084,	0.0632700642099132,	0,	0,	0],
        [0.016234612677335,	0,	0.0749428509642516,	0.0126540128419826,	0,	0.016234612677335,	0,	0.813144315120205,	0.0659531140016736,	0,	0,	0],
        [0.0159244908713871,	0,	0.069640276007868,	0.012938648833002,	0,	0.0167363778612893,	0,	0.795256037838448,	0.0679915350614877,	0,	0,	0],
        [0.0167363778612893,	0,	0.0733445103992966,	0.0135983070122975,	0,	0.0159244908713871,	0,	0.828979909836421,	0.0646932441650102,	0,	0,	0],
        [0.0151058887036376,	0,	0.0724805273805699,	0.0126971955131523,	0,	0.0157220165621173,	0,	0.802805470703116,	0.0624298787502581,	0,	0,	0],
        [0,	0,	0.058,	0,	0,	0.018,	0,	0.858,	0.066,	0,	0,	0],
        [0,	0,	0.0568263878346588,	0,	0,	0.0183642244651058,	0,	0.875361366170045,	0.0673354897053881,	0,	0,	0],
        [0,	0,	0.059173612165341,	0,	0,	0.0176357755348941,	0,	0.840638633829953,	0.0646645102946118,	0,	0,	0],
        [0,	0,	0.0600016079218542,	0,	0,	0.017378811334597,	0,	0.849798222771557,	0.0682776917731445,	0,	0,	0],
        [0,	0,	0.057445567506702,	0,	0,	0.0181720652565407,	0,	0.887609993050878,	0.0653690940593506,	0,	0,	0],
        [0,	0,	0.0585544324932979,	0,	0,	0.018621188665403,	0,	0.866201777228442,	0.0637223082268555,	0,	0,	0],
        [0,	0,	0.0559983920781458,	0,	0,	0.0178279347434592,	0,	0.828390006949122,	0.0666309059406494,	0,	0,	0],
        [0,	0,	0.0588504709553395,	0,	0,	0.0171715749060496,	0,	0.86204917702187,	0.0677565501868576,	0,	0,	0],
        [0,	0,	0.0564563649873072,	0,	0,	0.0180849477696896,	0,	0.818511737188366,	0.065032222705993,	0,	0,	0],
        [0,	0,	0.0606693697471736,	0,	0,	0.0184790591418703,	0,	0.845418895177908,	0.062962441322182,	0,	0,	0],
        [0,	0,	0.0577262794087783,	0,	0,	0.0177360607379981,	0,	0.880835152429149,	0.0663114751555285,	0,	0,	0],
        [0,	0,	0.0571495290446605,	0,	0,	0.0175209408581298,	0,	0.897488262811638,	0.0642434498131426,	0,	0,	0],
        [0,	0,	0.0595436350126931,	0,	0,	0.0182639392620019,	0,	0.853950822978134,	0.066967777294007,	0,	0,	0],
        [0,	0,	0.0553306302528266,	0,	0,	0.0188284250939504,	0,	0.835164847570854,	0.0690375586778183,	0,	0,	0],
        [0,	0,	0.058273720591222,	0,	0,	0.0179150522303105,	0,	0.870581104822092,	0.0656885248444719,	0,	0,	0],
        [0,	0,	0.0575872683297679,	0,	0,	0.017687268632382,	0,	0.843093138143542,	0.063390338423339,	0,	0,	0],
        [0.012,	0,	0.055,	0,	0,	0.015,	0,	0.855,	0.063,	0,	0,	0],
        [0.0117571836899294,	0,	0.0538870919121765,	0,	0,	0.0153035203875882,	0,	0.872300662092527,	0.0642747856278705,	0,	0,	0],
        [0.0122428163100706,	0,	0.0561129080878234,	0,	0,	0.0146964796124118,	0,	0.837699337907471,	0.0617252143721294,	0,	0,	0],
        [0.0115858742230646,	0,	0.0568980764776204,	0,	0,	0.0144823427788308,	0,	0.846826900314314,	0.0651741603289106,	0,	0,	0],
        [0.0121147101710272,	0,	0.0544742450494588,	0,	0,	0.0151433877137839,	0,	0.884506461606644,	0.0623977716021073,	0,	0,	0],
        [0.0118852898289728,	0,	0.0555257549505411,	0,	0,	0.0155176572211692,	0,	0.863173099685685,	0.0608258396710894,	0,	0,	0],
        [0.0124141257769354,	0,	0.0531019235223796,	0,	0,	0.014856612286216,	0,	0.825493538393356,	0.0636022283978926,	0,	0,	0],
        [0.0114477166040331,	0,	0.0558064810783392,	0,	0,	0.0143096457550414,	0,	0.859035019060255,	0.0646767069965459,	0,	0,	0],
        [0.0120566318464597,	0,	0.0535362081776189,	0,	0,	0.0150707898080746,	0,	0.815649808037358,	0.0620762125829933,	0,	0,	0],
        [0.0118240404919987,	0,	0.0575312988981819,	0,	0,	0.0153992159515586,	0,	0.842462885054909,	0.0601005121711737,	0,	0,	0],
        [0.0123193727612468,	0,	0.0547404373703932,	0,	0,	0.0147800506149984,	0,	0.877755309238837,	0.0632973171939135,	0,	0,	0],
        [0.0116806272387532,	0,	0.0541935189216608,	0,	0,	0.0146007840484415,	0,	0.894350191962646,	0.0613232930034543,	0,	0,	0],
        [0.0121759595080013,	0,	0.0564637918223814,	0,	0,	0.0152199493850016,	0,	0.850964980939749,	0.0639237874170067,	0,	0,	0],
        [0.0119433681535403,	0,	0.0524687011018183,	0,	0,	0.0156903542449587,	0,	0.832244690761166,	0.0658994878288265,	0,	0,	0],
        [0.012552283395967,	0,	0.0552595626296071,	0,	0,	0.0149292101919254,	0,	0.867537114945091,	0.0627026828060868,	0,	0,	0],
        [0.0113294165277282,	0,	0.0546086165196075,	0,	0,	0.014739390526985,	0,	0.840145260038145,	0.0605089594040963,	0,	0,	0]])

        #defining the error tables
        error_table = abs(resulto2 - experimental_results)
        
        error[i-1,j-1] = error_table.sum()

for i in range(0,15):
    for j in range(0,15):
        if error[i,j] == error.min():
            x = i
            y = j

print ("The minimum error is found in the following coordinates (number of nodes): x=", x, ", y=", y)
print ("The error of the optimized NN is: ", error[x,y])
print ("The optimum nodes combination therefore is: HL1: ", x+1, ", HL2: ", y+1)

######Prediction experiment (quadraple knockout)
#Repeat the network configuration
error_pred = np.zeros([15, 15])

np.random.seed(0)

wh1 = np.random.rand(len(inputs[0]),x+1)
wo1 = np.random.rand(x+1, y+1)
wh2 = np.random.rand(x+1, y+1)
wo2 = np.random.rand(y+1, len(outputs[0]))
lr = 0.5

for epoch in range(20000):
    zh1 = np.dot(inputs, wh1)
    afh1 = act_func_sigmoid(zh1)

    zo1 = np.dot(afh1, wo1)
    afo1 = act_func_sigmoid(zo1)

    zh2 = np.dot(afh1, wh2)
    afh2 = act_func_sigmoid(zh2)
            
    zo2 = np.dot(afo1, wo2)
    afo2 = act_func_sigmoid(zo2)

    ###1st hidden Layer
    error_out1 = ((0.5)*(np.power((afo1 - afh2), 2)))
    cost_afo1_der = afo1 - afh2
    afo_zo1_der = act_func_sigmoid_der(zo1)
    zo_wo1_der = afh1
    cost_wo1_der = np.dot(zo_wo1_der.T, cost_afo1_der*afo_zo1_der)

    cost_zo1_der = cost_afo1_der * afo_zo1_der
    zo_afh1_der = wo1
    cost_afh1_der = np.dot(cost_zo1_der, zo_afh1_der.T)
    afh_zh1_der = act_func_sigmoid_der(zh1)
    zh_wh1_der = inputs
    cost_wh1_der = np.dot(zh_wh1_der.T, afh_zh1_der*cost_afh1_der)

    #update weights
    wh1 -= lr*cost_wh1_der
    wo1 -= lr*cost_wo1_der

    #2nd hidden layer
    error_out2 = ((0.5)*(np.power((afo2 - outputs), 2)))
    cost_afo2_der = afo2 - outputs
    afo_zo2_der = act_func_sigmoid_der(zo2)
    zo_wo2_der = afh2
    cost_wo2_der = np.dot(zo_wo2_der.T, cost_afo2_der*afo_zo2_der)

    cost_zo2_der = cost_afo2_der * afo_zo2_der
    zo_afh2_der = wo2
    cost_afh2_der = np.dot(cost_zo2_der, zo_afh2_der.T)
    afh_zh2_der = act_func_sigmoid_der(zh2)
    zh_wh2_der = afh1
    cost_wh2_der = np.dot(zh_wh2_der.T, afh_zh2_der*cost_afh2_der)

    #update weights
    wh2 -= lr*cost_wh2_der
    wo2 -= lr*cost_wo2_der   

predictive_point = np.array([0.000833333333333333, 0.0031, 0.0002, 0]) #quadruple knockout

#outputs of each layer 
predh1 = act_func_sigmoid(np.dot(predictive_point, wh1))
predo1 = act_func_sigmoid(np.dot(predh1, wo1))
predo2 = act_func_sigmoid(np.dot(predo1, wo2))

print ("The results of 4KOs prediction are: ")
print (predo2)
